{"version":3,"sources":["private/verify/verifyClass.js"],"names":[],"mappings":"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","file":"private/verify/verifyClass.js","sourcesContent":["(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", 'op/Op', '../context', '../ast/Class', './context', './util', './verifyClassTraitCommon', './verifyLocals', './verifyMemberName', './verifyVal'], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Op_1 = require('op/Op');\n    var context_1 = require('../context');\n    var Class_1 = require('../ast/Class');\n    var context_2 = require('./context');\n    var util_1 = require('./util');\n    var verifyClassTraitCommon_1 = require('./verifyClassTraitCommon');\n    var verifyLocals_1 = require('./verifyLocals');\n    var verifyMemberName_1 = require('./verifyMemberName');\n    var verifyVal_1 = require('./verifyVal');\n    function verifyClass(_) {\n        const { opFields, opSuperClass, traits, opDo, statics, opConstructor, methods } = _;\n        Op_1.opEach(opFields, fields => {\n            for (const _ of fields)\n                verifyField(_);\n        });\n        verifyVal_1.verifyOpVal(opSuperClass);\n        verifyVal_1.verifyEachVal(traits);\n        Op_1.opEach(opDo, verifyClassTraitCommon_1.verifyClassTraitDo);\n        context_2.withMethods(() => {\n            for (const _ of statics)\n                verifyClassTraitCommon_1.verifyMethodImplLike(_);\n            Op_1.opEach(opConstructor, _ => verifyConstructor(_, opSuperClass !== null));\n            for (const _ of methods)\n                verifyClassTraitCommon_1.verifyMethodImplLike(_);\n        });\n    }\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.default = verifyClass;\n    function verifyConstructor(_, classHasSuper) {\n        const { loc, fun, memberArgs } = _;\n        util_1.makeUseOptional(Op_1.orThrow(fun.opDeclareThis));\n        context_2.withMethod(_, () => verifyVal_1.default(fun));\n        const superCall = context_2.results.constructorToSuper.get(_);\n        if (classHasSuper)\n            context_1.check(superCall !== undefined, loc, _ => _.superNeeded);\n        else\n            context_1.check(superCall === undefined, () => superCall.loc, _ => _.superForbidden);\n        for (const arg of memberArgs)\n            verifyLocals_1.setDeclareAccessed(arg, _);\n    }\n    function verifyField(_) {\n        verifyVal_1.verifyOpVal(_.opType);\n    }\n    function verifySuperCall(_, sk) {\n        const { loc, args } = _;\n        const meth = Op_1.orThrow(context_2.method, () => context_1.fail(loc, _ => _.superNeedsMethod));\n        context_2.results.superCallToMethod.set(_, meth);\n        if (meth instanceof Class_1.Constructor) {\n            context_1.check(sk === 0, loc, _ => _.superMustBeStatement);\n            context_2.results.constructorToSuper.set(meth, _);\n        }\n        verifyVal_1.verifyEachVal(args);\n    }\n    exports.verifySuperCall = verifySuperCall;\n    function verifySuperMember({ loc, name }) {\n        context_1.check(context_2.method !== null, loc, _ => _.superNeedsMethod);\n        verifyMemberName_1.default(name);\n    }\n    exports.verifySuperMember = verifySuperMember;\n});\n"],"sourceRoot":"/source/"}